SecurityTest
├── When inflation attack attempted [TEST-SEC-INFLATION]
│   ├── Given minimal deposit then donation [TEST-SEC-INFLATION-DONATION]
│   │   ├── It should victim receive > 0 shares [TEST-SEC-INFLATION-DONATION-001]
│   │   └── It should attacker gain nothing [TEST-SEC-INFLATION-DONATION-002]
│   └── Given virtual offset active [TEST-SEC-INFLATION-OFFSET]
│       └── It should prevent share price manipulation [TEST-SEC-INFLATION-OFFSET-001]
├── When zero amount operations [TEST-SEC-ZERO-AMOUNT]
│   ├── Given deposit of 0 [TEST-SEC-ZERO-AMOUNT-DEPOSIT]
│   │   └── It should revert with ZeroAssets [TEST-SEC-ZERO-AMOUNT-DEPOSIT-001]
│   ├── Given mint of 0 [TEST-SEC-ZERO-AMOUNT-MINT]
│   │   └── It should revert with ZeroShares [TEST-SEC-ZERO-AMOUNT-MINT-001]
│   ├── Given withdraw of 0 [TEST-SEC-ZERO-AMOUNT-WITHDRAW]
│   │   └── It should revert with ZeroAssets [TEST-SEC-ZERO-AMOUNT-WITHDRAW-001]
│   └── Given redeem of 0 [TEST-SEC-ZERO-AMOUNT-REDEEM]
│       └── It should revert with ZeroShares [TEST-SEC-ZERO-AMOUNT-REDEEM-001]
├── When non-admin calls admin functions [TEST-SEC-ACCESS-CONTROL]
│   ├── Given stranger calls setStrategy [TEST-SEC-ACCESS-SETSTR]
│   │   └── It should revert with Unauthorized [TEST-SEC-ACCESS-SETSTR-001]
│   ├── Given stranger calls pause [TEST-SEC-ACCESS-PAUSE]
│   │   └── It should revert with Unauthorized [TEST-SEC-ACCESS-PAUSE-001]
│   ├── Given stranger calls unpause [TEST-SEC-ACCESS-UNPAUSE]
│   │   └── It should revert with Unauthorized [TEST-SEC-ACCESS-UNPAUSE-001]
│   ├── Given stranger calls harvest [TEST-SEC-ACCESS-HARVEST]
│   │   └── It should revert with Unauthorized [TEST-SEC-ACCESS-HARVEST-001]
│   └── Given stranger calls emergencyWithdraw [TEST-SEC-ACCESS-EMERGENCY]
│       └── It should revert with Unauthorized [TEST-SEC-ACCESS-EMERGENCY-001]
├── When admin misconfigures strategy [TEST-SEC-MISCONFIG]
│   ├── Given strategy asset mismatch [TEST-SEC-MISCONFIG-ASSET]
│   │   └── It should revert with AssetMismatch [TEST-SEC-MISCONFIG-ASSET-001]
│   └── Given strategy is zero when assets exist [TEST-SEC-MISCONFIG-ZERO]
│       └── It should withdraw all to vault first [TEST-SEC-MISCONFIG-ZERO-001]
├── When ERC20 share operations [TEST-SEC-ERC20]
│   ├── Given transfer of shares [TEST-SEC-ERC20-TRANSFER]
│   │   ├── It should update balances correctly [TEST-SEC-ERC20-TRANSFER-001]
│   │   └── It should emit Transfer event [TEST-SEC-ERC20-TRANSFER-002]
│   ├── Given approve and transferFrom [TEST-SEC-ERC20-ALLOWANCE]
│   │   ├── It should allow third-party redeem [TEST-SEC-ERC20-ALLOWANCE-001]
│   │   └── It should reduce allowance [TEST-SEC-ERC20-ALLOWANCE-002]
│   └── Given totalSupply invariant [TEST-SEC-ERC20-SUPPLY]
│       └── It should equal sum of balances [TEST-SEC-ERC20-SUPPLY-001]
└── Invariant checks [TEST-SEC-INVARIANTS]
    ├── After deposit [TEST-SEC-INV-DEPOSIT]
    │   └── It should totalAssets equal vault+strategy [TEST-SEC-INV-DEPOSIT-001]
    ├── After withdrawal [TEST-SEC-INV-WITHDRAW]
    │   └── It should totalAssets equal vault+strategy [TEST-SEC-INV-WITHDRAW-001]
    ├── Share price direction [TEST-SEC-INV-PRICE]
    │   └── It should never decrease without loss event [TEST-SEC-INV-PRICE-001]
    ├── Balance bounds [TEST-SEC-INV-BALANCE]
    │   ├── It should no negative balances [TEST-SEC-INV-BALANCE-001]
    │   └── It should no balance > totalSupply [TEST-SEC-INV-BALANCE-002]
    └── Rounding dust [TEST-SEC-INV-ROUNDING]
        └── It should accumulated dust <= operation count [TEST-SEC-INV-ROUNDING-001]
